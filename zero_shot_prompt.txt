function toSnakeCase(input) {
  if (typeof input !== 'string') {
    throw new TypeError('Input must be a string');
  }

  return input
    .trim()
    // Convert camelCase to snake_case
    .replace(/([a-z0-9])([A-Z])/g, '$1_$2')
    // Replace spaces, hyphens, and underscores with a single underscore
    .replace(/[\s\-]+/g, '_')
    // Convert to lowercase
    .toLowerCase();
}
